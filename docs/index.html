<!-- Oh hi there! If you want to see the non-minified source code, check
the project GitHub repository: https://github.com/Nik89/CanOverhead -->

<!doctype html>
<html lang=en-US>
<head>
<meta charset=utf-8>
<title>CAN overhead, stuffing and bitrate calculator</title>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=author content="Nicola Furlan, Matjaž Guštin">
<link rel=license href=license.html>
<style>body{margin:.5rem;padding:1rem;font-family:Source Code Pro,Menlo,Consolas,Lucida Console,monospace;font-size:1.2rem;background-color:#f8f8f8}a{color:#1eaedb;text-decoration:none}a:hover{color:#0f90be}#main_title{text-align:center;font-size:2.5rem}#noscript_warning{margin:2rem;padding:1rem;font-size:1.5rem}#noscript_warning h3{color:#8b0000;font-style:italic}.input_form{background-color:#c6c6c67a}.input-error{color:red;font-size:1rem}.input_text{width:100%;padding:.5rem;margin:1em;box-sizing:border-box;font-family:inherit}#input_can_identifier{width:20em}#input_can_dlc_block{display:none}.small_label{font-size:1rem}.dropdown_select{height:2.5em;font-size:1rem;font-family:inherit;color:#1eaedb;border:2px solid #ccc;border-radius:5px}#input_can_payload{width:85em}.help_popup{font-weight:700}.buttons{margin:1rem;display:flex;justify-content:center}.button{background-color:#1eaedb;border:1rem;color:#fff;padding:1em 2em;text-align:center;font-size:1rem;cursor:pointer;border-radius:1em;transition-duration:.3s;font-family:inherit}.button:hover{background-color:#105169}.stuff_bit{text-decoration:underline;color:#b22ed0}.output_section_title{display:none}#output_list{font-size:1.2rem;width:90%;margin-left:1rem;display:none}#output_list li{margin-bottom:1.5rem}.output_can_text{margin-top:.5rem;background-color:#eee;white-space:break-spaces}.output_table{font-size:1.2rem;margin-left:auto;margin-right:auto;width:90%;border-collapse:collapse;display:none}.output_table td,.output_table th{border:.2em solid #ddd;padding:.5em}.output_table th{text-align:center;font-weight:700}.output_table tr{text-align:right}.output_table tr:nth-child(even){background-color:#eee}.output_table tr:hover{background-color:#ddd}.cell_text{text-align:left}footer{font-size:x-small;text-align:center;padding:1.5rem;margin:auto;width:60%}</style>
</head>
<body>
<h1 id=main_title>
CAN overhead, stuffing and bitrate calculator
</h1>
<noscript id=noscript_warning>
<hr>
<h3>
Please enable JavaScript for this website to work.
</h3>
<div>
If you don't trust the code (some paranoia is always good!), you can inspect it first on
<a href=https://github.com/Nik89/CanOverhead>GitHub</a>. The page works offline (no data is transmitted to any server), so alternatively you can download the files and open the
<i>index.html</i> file in your browser even when not connected to the internet.
</div>
<hr>
</noscript>
<div id=input_form>
<div class=input>
<div id=input_frame_type_block>
<label for=input_frame_type>Frame type</label>
<select name=input_frame_type id=input_frame_type class=dropdown_select onchange=alterInputFormOnFrameTypeChange(this)>
<option value=can_data11 selected>Base data frame (11-bit ID)</option>
<option value=can_data29>Extended data frame (29-bit ID)</option>
<option value=can_rtr11>Base RTR frame (11-bit ID)</option>
<option value=can_rtr29>Extended RTR frame (29-bit ID)</option>
<option value=canfd_data11 hidden>FD base data frame (11-bit ID)</option>
<option value=canfd_data29 hidden>FD extended data frame (29-bit ID)</option>
</select>
</div>
<div id=input_can_identifier_block>
<label for=input_can_identifier>Frame identifier</label>
<input id=input_can_identifier name=input_can_identifier class=input_text placeholder=42 autofocus>
<label for=input_can_identifier_base class=small_label>in base</label>
<select name=input_can_identifier_base id=input_can_identifier_base class=dropdown_select>
<option value=0b>Bin</option>
<option value="">Dec</option>
<option value=0x selected>Hex</option>
</select>
</div>
<div id=input_can_payload_block>
<label for=input_can_payload>
Frame payload data
</label>
<span class=small_label>
(hex-only, ignoring spaces, commas and '0x' prefixes)
</span>
<input id=input_can_payload name=input_can_payload class=input_text placeholder="43 41 4E">
</div>
<div id=input_can_dlc_block>
<label for=input_can_dlc>RTR frame Data Length Code (DLC)</label>
<span title="This should be the payload length of the frame transmitted by the receiver(s) of the RTR frame. RTR frames themselves have no payload." class=help_popup>&#9432;
</span>
<select name=input_can_dlc id=input_can_dlc class=dropdown_select>
<option value=0 selected>0</option>
<option value=1>1</option>
<option value=2>2</option>
<option value=3>3</option>
<option value=4>4</option>
<option value=5>5</option>
<option value=6>6</option>
<option value=7>7</option>
<option value=8>8</option>
</select>
</div>
<div id=input_can_bitrate_block>
<label for=input_can_bitrate>CAN bitrate</label>
<span title="In KILObit (multiples of 1000), not KIBIbit (multiples of 1024)" class=help_popup>&#9432;
</span>
<select name=input_can_bitrate id=input_can_bitrate class=dropdown_select>
<option value=5e6>5 Mbit/s</option>
<option value=2e6>2 Mbit/s</option>
<option value=1e6>1 Mbit/s</option>
<option value=800e3>800 kbit/s</option>
<option value=500e3>500 kbit/s</option>
<option value=250e3>250 kbit/s</option>
<option value=125e3 selected>125 kbit/s</option>
<option value=50e3>50 kbit/s</option>
<option value=20e3>20 kbit/s</option>
<option value=10e3>10 kbit/s</option>
<option value=5e3>5 kbit/s</option>
</select>
</div>
<div id=input_error class=input-error></div>
</div>
<div class=buttons>
<button class=button onclick=calculate()>Compute</button>
</div>
<div class=output>
<h4 id=output_list_title class=output_section_title>
Whole frame
</h4>
<ul id=output_list>
<li>Whole frame without stuff bits
<span id=output_can_whole_frame_len></span>
<div id=output_can_whole_frame class=output_can_text></div>
</li>
<li>Whole frame with stuff bits
<span class=small_label>
(as appears on the bus)
</span>
<span id=output_can_whole_frame_stuffed_len></span>
<div id=output_can_whole_frame_stuffed class=output_can_text></div>
</li>
<li>Worst-case frame length after stuffing
<span class=small_label>
(assuming same ID and payload lengths)
</span>
<span title="Some bit sequences require more stuff bits than others. If the CAN ID and also the payload of the same size as the provided inputs but their contents are the worst possible (in terms of stuffing requirements), this is the length of the whole frame after the stuffing." class=help_popup>&#9432;
</span>
<div id=output_max_length class=output_can_text></div>
</li>
<li>Whole frame transfer time
<span class=small_label>
(including stuff bits)
</span>
<span title="The time it takes to transfer the whole stuffed frame across the bus at the given bitrate, from the Start Of Frame bit (included) until the very first moment the next frame could be transmitted (next SOF excluded)." class=help_popup>&#9432;
</span>
<div id=output_transfer_time class=output_can_text></div>
</li>
<li>Overhead
<span class=small_label>
(including stuff bits)
</span>
<span title="Overhead = metadata-only bits / all bits. As the CAN ID may be itself already useful data and not only metadata (e.g. indicate a specific command for the receivers), an option where the ID is considered part of the metadata (thus adding to the overhead) is given as well as one where the ID is considered part of the data (thus not adding to the overhead)." class=help_popup>&#9432;
</span>
<div id=output_overhead_no_id class=output_can_text></div>
<div id=output_overhead_with_id class=output_can_text></div>
</li>
<li>Effective bitrate to transfer the data
<span class=small_label>
(including stuff bits)
</span>
<span title="Effective bitrate = data-only bits / whole frame transfer time. It is the bitrate at which the data is effectively transferred across the bus in case of continuous frame-after-frame transmission of the same frame. The same considerations for CAN ID as data or as metadata apply as for the Overhead field." class=help_popup>&#9432;
</span>
<div id=output_effective_bitrate_no_id class=output_can_text></div>
<div id=output_effective_bitrate_with_id class=output_can_text></div>
</li>
</ul>
<h4 id=output_table_title class=output_section_title>
Breakdown of frame fields
</h4>
<table class=output_table id=output_table_data11bit>
<tr>
<th>#</th>
<th>Field name</th>
<th>Length<br>[bits]</th>
<th>Content<br>[bin]</th>
<th>Content<br>[hex]</th>
</tr>
<tr>
<td>1</td>
<td class=cell_text>Start of Frame (SOF)</td>
<td id=output_can_data11_field01_len></td>
<td id=output_can_data11_field01></td>
<td id=output_can_data11_field01_hex></td>
</tr>
<tr>
<td>2</td>
<td class=cell_text>Identifier (ID)</td>
<td id=output_can_data11_field02_len></td>
<td id=output_can_data11_field02></td>
<td id=output_can_data11_field02_hex></td>
</tr>
<tr>
<td>3</td>
<td class=cell_text>Remote Transfer Request (RTR)</td>
<td id=output_can_data11_field03_len></td>
<td id=output_can_data11_field03></td>
<td id=output_can_data11_field03_hex></td>
</tr>
<tr>
<td>4</td>
<td class=cell_text>Identifier Extension (IDE)</td>
<td id=output_can_data11_field04_len></td>
<td id=output_can_data11_field04></td>
<td id=output_can_data11_field04_hex></td>
</tr>
<tr>
<td>5</td>
<td class=cell_text>Reserved 0 (R0)</td>
<td id=output_can_data11_field05_len></td>
<td id=output_can_data11_field05></td>
<td id=output_can_data11_field05_hex></td>
</tr>
<tr>
<td>6</td>
<td class=cell_text>Data Length Code (DLC)</td>
<td id=output_can_data11_field06_len></td>
<td id=output_can_data11_field06></td>
<td id=output_can_data11_field06_hex></td>
</tr>
<tr>
<td>7</td>
<td class=cell_text>Data (Payload)</td>
<td id=output_can_data11_field07_len></td>
<td id=output_can_data11_field07></td>
<td id=output_can_data11_field07_hex></td>
</tr>
<tr>
<td>8</td>
<td class=cell_text>Cyclic Redundancy Check (CRC)</td>
<td id=output_can_data11_field08_len></td>
<td id=output_can_data11_field08></td>
<td id=output_can_data11_field08_hex></td>
</tr>
<tr>
<td>9</td>
<td class=cell_text>CRC Delimiter</td>
<td id=output_can_data11_field09_len></td>
<td id=output_can_data11_field09></td>
<td id=output_can_data11_field09_hex></td>
</tr>
<tr>
<td>10</td>
<td class=cell_text>Acknowledgement (ACK) Slot
<span title="Set to 1 by transmitted, pulled to 0 by receiver(s) to acknowledge." class=help_popup>&#9432;
</span>
</td>
<td id=output_can_data11_field10_len></td>
<td id=output_can_data11_field10></td>
<td id=output_can_data11_field10_hex></td>
</tr>
<tr>
<td>11</td>
<td class=cell_text>Acknowledgement Delimiter</td>
<td id=output_can_data11_field11_len></td>
<td id=output_can_data11_field11></td>
<td id=output_can_data11_field11_hex></td>
</tr>
<tr>
<td>12</td>
<td class=cell_text>End of Frame (EOF)</td>
<td id=output_can_data11_field12_len></td>
<td id=output_can_data11_field12></td>
<td id=output_can_data11_field12_hex></td>
</tr>
<tr>
<td>13</td>
<td class=cell_text>Inter-Frame Space (IFS)
<span title="Minimum silence required between 2 consecutive frames." class=help_popup>&#9432;
</span>
</td>
<td id=output_can_data11_field13_len></td>
<td id=output_can_data11_field13></td>
<td id=output_can_data11_field13_hex></td>
</tr>
</table>
<table class=output_table id=output_table_data29bit>
<tr>
<th>#</th>
<th>Field name</th>
<th>Length<br>[bits]</th>
<th>Content<br>[bin]</th>
<th>Content<br>[hex]</th>
</tr>
<tr>
<td>1</td>
<td class=cell_text>Start of Frame (SOF)</td>
<td id=output_can_data29_field01_len></td>
<td id=output_can_data29_field01></td>
<td id=output_can_data29_field01_hex></td>
</tr>
<tr>
<td>2</td>
<td class=cell_text>Identifier part A (ID A)</td>
<td id=output_can_data29_field02_len></td>
<td id=output_can_data29_field02></td>
<td id=output_can_data29_field02_hex></td>
</tr>
<tr>
<td>3</td>
<td class=cell_text>Substitute Remote Request (SRR)</td>
<td id=output_can_data29_field03_len></td>
<td id=output_can_data29_field03></td>
<td id=output_can_data29_field03_hex></td>
</tr>
<tr>
<td>4</td>
<td class=cell_text>Identifier Extension (IDE)</td>
<td id=output_can_data29_field04_len></td>
<td id=output_can_data29_field04></td>
<td id=output_can_data29_field04_hex></td>
</tr>
<tr>
<td>5</td>
<td class=cell_text>Identifier part B (ID B)</td>
<td id=output_can_data29_field05_len></td>
<td id=output_can_data29_field05></td>
<td id=output_can_data29_field05_hex></td>
</tr>
<tr>
<td>6</td>
<td class=cell_text>Remote Transfer Request (RTR)</td>
<td id=output_can_data29_field06_len></td>
<td id=output_can_data29_field06></td>
<td id=output_can_data29_field06_hex></td>
</tr>
<tr>
<td>7</td>
<td class=cell_text>Reserved Bit 1 (R1)</td>
<td id=output_can_data29_field07_len></td>
<td id=output_can_data29_field07></td>
<td id=output_can_data29_field07_hex></td>
</tr>
<tr>
<td>8</td>
<td class=cell_text>Reserved Bit 0 (R0)</td>
<td id=output_can_data29_field08_len></td>
<td id=output_can_data29_field08></td>
<td id=output_can_data29_field08_hex></td>
</tr>
<tr>
<td>9</td>
<td class=cell_text>Data Length Code (DLC)</td>
<td id=output_can_data29_field09_len></td>
<td id=output_can_data29_field09></td>
<td id=output_can_data29_field09_hex></td>
</tr>
<tr>
<td>10</td>
<td class=cell_text>Data (Payload)</td>
<td id=output_can_data29_field10_len></td>
<td id=output_can_data29_field10></td>
<td id=output_can_data29_field10_hex></td>
</tr>
<tr>
<td>11</td>
<td class=cell_text>Cyclic Redundancy Check (CRC)</td>
<td id=output_can_data29_field11_len></td>
<td id=output_can_data29_field11></td>
<td id=output_can_data29_field11_hex></td>
</tr>
<tr>
<td>12</td>
<td class=cell_text>CRC Delimiter</td>
<td id=output_can_data29_field12_len></td>
<td id=output_can_data29_field12></td>
<td id=output_can_data29_field12_hex></td>
</tr>
<tr>
<td>13</td>
<td class=cell_text>Acknowledgement (ACK) Slot
<span title="Set to 1 by transmitted, pulled to 0 by receiver(s) to acknowledge." class=help_popup>&#9432;
</span>
</td>
<td id=output_can_data29_field13_len></td>
<td id=output_can_data29_field13></td>
<td id=output_can_data29_field13_hex></td>
</tr>
<tr>
<td>14</td>
<td class=cell_text>Acknowledgement Delimiter</td>
<td id=output_can_data29_field14_len></td>
<td id=output_can_data29_field14></td>
<td id=output_can_data29_field14_hex></td>
</tr>
<tr>
<td>15</td>
<td class=cell_text>End of Frame (EOF)</td>
<td id=output_can_data29_field15_len></td>
<td id=output_can_data29_field15></td>
<td id=output_can_data29_field15_hex></td>
</tr>
<tr>
<td>16</td>
<td class=cell_text>Inter-Frame Space (IFS)
<span title="Minimum silence required between 2 consecutive frames." class=help_popup>&#9432;
</span>
</td>
<td id=output_can_data29_field16_len></td>
<td id=output_can_data29_field16></td>
<td id=output_can_data29_field16_hex></td>
</tr>
</table>
</div>
</div>
<footer>
<div>
Made with &#x1f499; by
<a href=https://github.com/Nik89>Nicola Furlan</a>
and <a href=https://matjaz.it/ >Matjaž Guštin</a>
</div>
<div>
Version 1.2.0 &ndash;
<a href=changelog.html>
Changelog
</a>
&ndash;
<a href=https://github.com/Nik89/CanOverhead>
Source code on GitHub
</a>
&ndash;
<a href=https://github.com/Nik89/CanOverhead/issues>
Found a bug?
</a>
</div>
<br>
<div>
This website does not use cookies, does not advertise nor track the users. All calculations happen in your browser, no data is sent to any server. The results of the calculator are provided with best-effort from the authors but with no guarantee of correctness, as stated formally in the <a href=license.html>source code license</a>.
</div>
</footer>
<script>const _Seqbit={ZERO:0,ONE:1,ZERO_STUFF:2,ONE_STUFF:3};class BitSequence{constructor(e=[],t=!1){this._isStuffed=Boolean(t),this._sequence=[],this.extend(e)}extend(e){try{this._appendOneBit(e)}catch(t){for(let t of e)"string"==typeof t&&""===t.trim()||this._appendOneBit(t)}return this}_appendOneBit(e){switch(e){case _Seqbit.ZERO:case!1:case"0":this._sequence.push(_Seqbit.ZERO);break;case _Seqbit.ONE:case!0:case"1":this._sequence.push(_Seqbit.ONE);break;case _Seqbit.ZERO_STUFF:case"2":this._sequence.push(_Seqbit.ZERO_STUFF);break;case _Seqbit.ONE_STUFF:case"3":this._sequence.push(_Seqbit.ONE_STUFF);break;default:throw new RangeError("Unsupported character: "+e)}}length(){return this._sequence.length}equal(e){if(!(e instanceof BitSequence))return!1;if(e._sequence.length!==this._sequence.length)return!1;for(let t=0;t<this._sequence.length;t++)if(this._sequence[t]!==e._sequence[t])return!1;return!0}static maxAmountOfStuffBits(e){return e<1?0:Math.floor((e-1)/4)}static maxLengthAfterStuffing(e){return e+this.maxAmountOfStuffBits(e)}applyBitStuffing(){if(this._isStuffed)throw new TypeError("Bits sequence already stuffed.");let e=[],t=1,i=void 0;for(let n of this._sequence)if(n===i?t++:t=1,e.push(n),5===t){let r;n===_Seqbit.ZERO?(r=_Seqbit.ONE_STUFF,i=_Seqbit.ONE):(r=_Seqbit.ZERO_STUFF,i=_Seqbit.ZERO),e.push(r),t=1}else i=n;return new BitSequence(e,!0)}removeBitStuffing(){if(!this._isStuffed)throw new TypeError("Bits sequence already de-stuffed.");const e=this._sequence.filter(e=>e===_Seqbit.ZERO||e===_Seqbit.ONE);return new BitSequence(e,!1)}static _seqBitToString(e,t="",i=""){switch(e){case _Seqbit.ZERO:return"0";case _Seqbit.ONE:return"1";case _Seqbit.ZERO_STUFF:return t+"0"+i;case _Seqbit.ONE_STUFF:return t+"1"+i;default:throw new RangeError("Unsupported sequence bit: "+e)}}toBinString(e="",t=""){let i="";for(let n of this._sequence)i+=BitSequence._seqBitToString(n,e,t);return i}toBinStringWithSpacesRightAlign(e="",t=""){let i="",n=this._sequence.length;for(let r of this._sequence)i+=BitSequence._seqBitToString(r,e,t),--n%4==0&&n>0&&(i+=" ");return i}toBinStringWithSpacesLeftAlign(e="",t=""){let i="",n=0;for(let r of this._sequence)4===n&&(i+=" ",n=0),i+=BitSequence._seqBitToString(r,e,t),n++;return i}toHexString(){let e="",t=0,i=0;for(let n=this._sequence.length-1;n>=0;n--)this._sequence[n]!==_Seqbit.ONE&&this._sequence[n]!==_Seqbit.ONE_STUFF||(t|=1<<i),4===++i&&(e=t.toString(16)+e,i=0,t=0);return i>0&&(e=t.toString(16)+e),e.toUpperCase()}[Symbol.iterator](){return this._sequence.values()}}const Bit={DOMINANT:!1,RECESSIVE:!0},MAX_ID_VALUE_11_BIT=2047,MAX_ID_VALUE_29_BIT=536870911,MIN_ID_VALUE=0,MAX_PAYLOAD_BYTES=8,Field={ID:1,PAYLOAD:2,DLC:3,TYPE:4,BITRATE:5};class ValidationError extends Error{constructor(e,t){super(e),this.name="ValidationError",this.field=t}}class _CanFrame{constructor(e,t=null,i,n=null){if("number"!=typeof e)throw new TypeError("Identifier must be a number.");if(e<MIN_ID_VALUE||e>i)throw new ValidationError("Identifier out of bounds. Valid range: ["+MIN_ID_VALUE+", "+i+"] = [0x"+MIN_ID_VALUE.toString(16).toUpperCase()+", 0x"+i.toString(16).toUpperCase()+"] = [0b"+MIN_ID_VALUE.toString(2).toUpperCase()+", 0b"+i.toString(2).toUpperCase()+"]",Field.ID);if(null===t)t=new Uint8Array(0);else if(!(t instanceof Uint8Array))throw new TypeError("Payload must be a Uint8Array.");if(null===n){if(t.length>MAX_PAYLOAD_BYTES)throw new ValidationError("Payload too long. Valid length range: [0, "+MAX_PAYLOAD_BYTES+"] bytes",Field.PAYLOAD)}else{if("number"!=typeof n)throw new TypeError("DLC field must be an integer.");if(n<0||n>MAX_PAYLOAD_BYTES)throw new ValidationError("DLC field out of bounds. Valid range: [0, "+MAX_PAYLOAD_BYTES+"] bytes",Field.DLC);if(0!==t.length)throw new ValidationError("Payload must be empty for RTR frames.",Field.PAYLOAD)}this.id=e,this.payload=t,this.dlc=n}payloadAsBitSequence(){let e=new BitSequence;for(let t of this.payload)e.extend(t.toString(2).padStart(8,"0"));return e}dataLengthCode(){return null!==this.dlc?new BitSequence(this.dlc.toString(2).padStart(4,"0")):new BitSequence(this.payload.length.toString(2).padStart(4,"0"))}remoteTransmissionRequest(){return null!==this.dlc?new BitSequence(Bit.RECESSIVE):new BitSequence(Bit.DOMINANT)}dataBitLength(){return 8*this.payload.length}}class CanFrame11Bit extends _CanFrame{constructor(e,t=null,i=null){super(e,t,MAX_ID_VALUE_11_BIT,i)}idBitLength(){return 11}field01_startOfFrame(){return new BitSequence(Bit.DOMINANT)}field02_identifier(){return new BitSequence(this.id.toString(2).padStart(11,"0"))}field03_remoteTransmissionRequest(){return this.remoteTransmissionRequest()}field04_identifierExtensionBit(){return new BitSequence(Bit.DOMINANT)}field05_reservedBit(){return new BitSequence(Bit.DOMINANT)}field06_dataLengthCode(){return this.dataLengthCode()}field07_dataField(){return this.payloadAsBitSequence()}field08_crc(){let e=new BitSequence;e.extend(this.field01_startOfFrame()),e.extend(this.field02_identifier()),e.extend(this.field03_remoteTransmissionRequest()),e.extend(this.field04_identifierExtensionBit()),e.extend(this.field05_reservedBit()),e.extend(this.field06_dataLengthCode()),e.extend(this.field07_dataField());let t=crc15(e);return new BitSequence(t.toString(2).padStart(15,"0"))}field09_crcDelimiter(){return new BitSequence(Bit.RECESSIVE)}field10_ackSlot(){return new BitSequence(Bit.RECESSIVE)}field11_ackDelimiter(){return new BitSequence(Bit.RECESSIVE)}field12_endOfFrame(){return new BitSequence([Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE])}field13_interFrameSpace(){return new BitSequence([Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE])}wholeFrame(){let e=new BitSequence;return e.extend(this.field01_startOfFrame()),e.extend(this.field02_identifier()),e.extend(this.field03_remoteTransmissionRequest()),e.extend(this.field04_identifierExtensionBit()),e.extend(this.field05_reservedBit()),e.extend(this.field06_dataLengthCode()),e.extend(this.field07_dataField()),e.extend(this.field08_crc()),e.extend(this.field09_crcDelimiter()),e.extend(this.field10_ackSlot()),e.extend(this.field11_ackDelimiter()),e.extend(this.field12_endOfFrame()),e.extend(this.field13_interFrameSpace()),e}wholeFrameStuffed(){let e=new BitSequence;return e.extend(this.field01_startOfFrame()),e.extend(this.field02_identifier()),e.extend(this.field03_remoteTransmissionRequest()),e.extend(this.field04_identifierExtensionBit()),e.extend(this.field05_reservedBit()),e.extend(this.field06_dataLengthCode()),e.extend(this.field07_dataField()),e.extend(this.field08_crc()),(e=e.applyBitStuffing()).extend(this.field09_crcDelimiter()),e.extend(this.field10_ackSlot()),e.extend(this.field11_ackDelimiter()),e.extend(this.field12_endOfFrame()),e.extend(this.field13_interFrameSpace()),e}maxLengthAfterStuffing(){let e=1;e+=11,e+=1,e+=1,e+=1,e+=4,e+=8*this.payload.length,e+=15;let t=BitSequence.maxLengthAfterStuffing(e);return t+=1,t+=1,t+=1,t+=7,t+=3}}class CanFrame29Bit extends _CanFrame{constructor(e,t=null,i=null){super(e,t,MAX_ID_VALUE_29_BIT,i)}idBitLength(){return 29}field01_startOfFrame(){return new BitSequence(Bit.DOMINANT)}field02_identifierPartA(){const e=this.id>>18&2047;return new BitSequence(e.toString(2).padStart(11,"0"))}field03_substituteRemoteRequest(){return new BitSequence(Bit.RECESSIVE)}field04_identifierExtensionBit(){return new BitSequence(Bit.RECESSIVE)}field05_identifierPartB(){const e=262143&this.id;return new BitSequence(e.toString(2).padStart(18,"0"))}field06_remoteTransmissionRequest(){return this.remoteTransmissionRequest()}field07_reservedBit1(){return new BitSequence(Bit.DOMINANT)}field08_reservedBit0(){return new BitSequence(Bit.DOMINANT)}field09_dataLengthCode(){return this.dataLengthCode()}field10_dataField(){return this.payloadAsBitSequence()}field11_crc(){let e=new BitSequence;e.extend(this.field01_startOfFrame()),e.extend(this.field02_identifierPartA()),e.extend(this.field03_substituteRemoteRequest()),e.extend(this.field04_identifierExtensionBit()),e.extend(this.field05_identifierPartB()),e.extend(this.field06_remoteTransmissionRequest()),e.extend(this.field07_reservedBit1()),e.extend(this.field08_reservedBit0()),e.extend(this.field09_dataLengthCode()),e.extend(this.field10_dataField());const t=crc15(e);return new BitSequence(t.toString(2).padStart(15,"0"))}field12_crcDelimiter(){return new BitSequence(Bit.RECESSIVE)}field13_ackSlot(){return new BitSequence(Bit.RECESSIVE)}field14_ackDelimiter(){return new BitSequence(Bit.RECESSIVE)}field15_endOfFrame(){return new BitSequence([Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE])}field16_interFrameSpace(){return new BitSequence([Bit.RECESSIVE,Bit.RECESSIVE,Bit.RECESSIVE])}wholeFrame(){let e=new BitSequence;return e.extend(this.field01_startOfFrame()),e.extend(this.field02_identifierPartA()),e.extend(this.field03_substituteRemoteRequest()),e.extend(this.field04_identifierExtensionBit()),e.extend(this.field05_identifierPartB()),e.extend(this.field06_remoteTransmissionRequest()),e.extend(this.field07_reservedBit1()),e.extend(this.field08_reservedBit0()),e.extend(this.field09_dataLengthCode()),e.extend(this.field10_dataField()),e.extend(this.field11_crc()),e.extend(this.field12_crcDelimiter()),e.extend(this.field13_ackSlot()),e.extend(this.field14_ackDelimiter()),e.extend(this.field15_endOfFrame()),e.extend(this.field16_interFrameSpace()),e}wholeFrameStuffed(){let e=new BitSequence;return e.extend(this.field01_startOfFrame()),e.extend(this.field02_identifierPartA()),e.extend(this.field03_substituteRemoteRequest()),e.extend(this.field04_identifierExtensionBit()),e.extend(this.field05_identifierPartB()),e.extend(this.field06_remoteTransmissionRequest()),e.extend(this.field07_reservedBit1()),e.extend(this.field08_reservedBit0()),e.extend(this.field09_dataLengthCode()),e.extend(this.field10_dataField()),e.extend(this.field11_crc()),(e=e.applyBitStuffing()).extend(this.field12_crcDelimiter()),e.extend(this.field13_ackSlot()),e.extend(this.field14_ackDelimiter()),e.extend(this.field15_endOfFrame()),e.extend(this.field16_interFrameSpace()),e}maxLengthAfterStuffing(){let e=1;e+=11,e+=1,e+=1,e+=18,e+=1,e+=1,e+=1,e+=4,e+=8*this.payload.length,e+=15;let t=BitSequence.maxLengthAfterStuffing(e);return t+=1,t+=1,t+=1,t+=7,t+=3}}function crc(e,t,i){let n=0,r=1<<i;t&=~r,r>>=1;for(let d of e)(n^=d<<i-1)&r?n=n<<1^t:n<<=1;return n&(1<<i)-1}function crc15(e){return crc(e,50585,15)}function crc17(e){return crc(e,223323,17)}function crc21(e){return crc(e,3156121,21)}</script>
<script>function display(t,a){document.getElementById(t).innerHTML=a}function clear(t){display(t,"")}function read(t){return document.getElementById(t).value}function hide(t){document.getElementById(t).style.display="none"}function unhide(t){document.getElementById(t).style.display="block"}function displayInputFormError(t){display("input_error",t)}function displayUnknownError(t){display("input_error",'An unexpected error occurred :( Please <a href="https://github.com/Nik89/CanOverhead/issues">report</a> the conditions leading to your bug! Here is some debug information: '+t.message),console.error(t)}function highlightIncorrectInput(t){document.getElementById(t).style.borderColor="#ff3c3c"}function clearHighlight(t){document.getElementById(t).style.borderColor=""}function clearErrorsAndOutputs(){clear("input_error"),clearHighlight("input_can_identifier"),clearHighlight("input_can_payload"),clearHighlight("input_can_dlc"),clearHighlight("input_frame_type"),clear("output_can_whole_frame"),clear("output_can_whole_frame_len"),clear("output_can_whole_frame_stuffed"),clear("output_can_whole_frame_stuffed_len"),clear("output_max_length"),clear("output_transfer_time"),clear("output_overhead_no_id"),clear("output_overhead_with_id"),clear("output_effective_bitrate_no_id"),clear("output_effective_bitrate_with_id"),clear("output_can_data11_field01"),clear("output_can_data11_field01_len"),clear("output_can_data11_field01_hex"),clear("output_can_data11_field02"),clear("output_can_data11_field02_len"),clear("output_can_data11_field02_hex"),clear("output_can_data11_field03"),clear("output_can_data11_field03_len"),clear("output_can_data11_field03_hex"),clear("output_can_data11_field04"),clear("output_can_data11_field04_len"),clear("output_can_data11_field04_hex"),clear("output_can_data11_field05"),clear("output_can_data11_field05_len"),clear("output_can_data11_field05_hex"),clear("output_can_data11_field06"),clear("output_can_data11_field06_len"),clear("output_can_data11_field06_hex"),clear("output_can_data11_field07"),clear("output_can_data11_field07_len"),clear("output_can_data11_field07_hex"),clear("output_can_data11_field08"),clear("output_can_data11_field08_len"),clear("output_can_data11_field08_hex"),clear("output_can_data11_field09"),clear("output_can_data11_field09_len"),clear("output_can_data11_field09_hex"),clear("output_can_data11_field10"),clear("output_can_data11_field10_len"),clear("output_can_data11_field10_hex"),clear("output_can_data11_field11"),clear("output_can_data11_field11_len"),clear("output_can_data11_field11_hex"),clear("output_can_data11_field12"),clear("output_can_data11_field12_len"),clear("output_can_data11_field12_hex"),clear("output_can_data11_field13"),clear("output_can_data11_field13_len"),clear("output_can_data11_field13_hex"),clear("output_can_data29_field01"),clear("output_can_data29_field01_len"),clear("output_can_data29_field01_hex"),clear("output_can_data29_field02"),clear("output_can_data29_field02_len"),clear("output_can_data29_field02_hex"),clear("output_can_data29_field03"),clear("output_can_data29_field03_len"),clear("output_can_data29_field03_hex"),clear("output_can_data29_field04"),clear("output_can_data29_field04_len"),clear("output_can_data29_field04_hex"),clear("output_can_data29_field05"),clear("output_can_data29_field05_len"),clear("output_can_data29_field05_hex"),clear("output_can_data29_field06"),clear("output_can_data29_field06_len"),clear("output_can_data29_field06_hex"),clear("output_can_data29_field07"),clear("output_can_data29_field07_len"),clear("output_can_data29_field07_hex"),clear("output_can_data29_field08"),clear("output_can_data29_field08_len"),clear("output_can_data29_field08_hex"),clear("output_can_data29_field09"),clear("output_can_data29_field09_len"),clear("output_can_data29_field09_hex"),clear("output_can_data29_field10"),clear("output_can_data29_field10_len"),clear("output_can_data29_field10_hex"),clear("output_can_data29_field11"),clear("output_can_data29_field11_len"),clear("output_can_data29_field11_hex"),clear("output_can_data29_field12"),clear("output_can_data29_field12_len"),clear("output_can_data29_field12_hex"),clear("output_can_data29_field13"),clear("output_can_data29_field13_len"),clear("output_can_data29_field13_hex"),clear("output_can_data29_field14"),clear("output_can_data29_field14_len"),clear("output_can_data29_field14_hex"),clear("output_can_data29_field15"),clear("output_can_data29_field15_len"),clear("output_can_data29_field15_hex"),clear("output_can_data29_field16"),clear("output_can_data29_field16_len"),clear("output_can_data29_field16_hex"),clear("output_can_data29_field16_hex"),hide("output_list_title"),hide("output_list"),hide("output_table_title"),hide("output_table_data11bit"),hide("output_table_data29bit")}function displayCanFrameWholeFrame(t,a){const e=t.wholeFrame();display("output_can_whole_frame_len",`[${e.length()} bits]`),display("output_can_whole_frame",e.toBinStringWithSpacesLeftAlign());const i=t.wholeFrameStuffed(),_=i.length()-e.length(),n=i.length()/a,d=(1e3*n).toFixed(3),l=t.dataBitLength(),r=t.dataBitLength()+t.idBitLength(),u=i.length()-l,o=i.length()-r;display("output_can_whole_frame_stuffed_len",`[${i.length()} bits, of which `+`<span class="stuff_bit">${_} stuff bits</span>]`),display("output_can_whole_frame_stuffed",i.toBinStringWithSpacesLeftAlign('<span class="stuff_bit">',"</span>")),display("output_max_length",`${t.maxLengthAfterStuffing()} bits`),display("output_transfer_time",`${d} ms`),display("output_overhead_no_id",`Data (just payload): ${l.toString().padStart(2)} bits. Metadata: ${u.toString().padStart(2)} bits = ${overheadPercentageStr(l,u)}% of frame`),display("output_overhead_with_id",`Data (ID + payload): ${r.toString().padStart(2)} bits. Metadata: ${o.toString().padStart(2)} bits = ${overheadPercentageStr(r,o)}% of frame`),display("output_effective_bitrate_no_id",`Data (just payload): ${effectiveBitrateKbpsStr(l,n)} kbit/s`),display("output_effective_bitrate_with_id",`Data (ID + payload): ${effectiveBitrateKbpsStr(r,n)} kbit/s`),unhide("output_list_title"),unhide("output_list"),unhide("output_transfer_time"),unhide("output_overhead_no_id"),unhide("output_overhead_with_id"),unhide("output_effective_bitrate_no_id"),unhide("output_effective_bitrate_with_id")}function overheadPercentageStr(t,a){return(100*(a/(t+a))).toFixed(2).padStart(6)}function effectiveBitrateKbpsStr(t,a){return(t/a/1e3).toFixed(3).padStart(8)}function displayCanFrame11BitFields(t){let a;display("output_can_data11_field01_len",(a=t.field01_startOfFrame()).length().toString()),display("output_can_data11_field01",a.toBinString()),display("output_can_data11_field01_hex",a.toHexString()),display("output_can_data11_field02_len",(a=t.field02_identifier()).length().toString()),display("output_can_data11_field02",a.toBinStringWithSpacesRightAlign()),display("output_can_data11_field02_hex",a.toHexString()),display("output_can_data11_field03_len",(a=t.field03_remoteTransmissionRequest()).length().toString()),display("output_can_data11_field03",a.toBinString()),display("output_can_data11_field03_hex",a.toHexString()),display("output_can_data11_field04_len",(a=t.field04_identifierExtensionBit()).length().toString()),display("output_can_data11_field04",a.toBinString()),display("output_can_data11_field04_hex",a.toHexString()),display("output_can_data11_field05_len",(a=t.field05_reservedBit()).length().toString()),display("output_can_data11_field05",a.toBinString()),display("output_can_data11_field05_hex",a.toHexString()),display("output_can_data11_field06_len",(a=t.field06_dataLengthCode()).length().toString()),display("output_can_data11_field06",a.toBinString()),display("output_can_data11_field06_hex",a.toHexString()),display("output_can_data11_field07_len",(a=t.field07_dataField()).length().toString()),display("output_can_data11_field07",a.toBinStringWithSpacesRightAlign()),display("output_can_data11_field07_hex",a.toHexString()),display("output_can_data11_field08_len",(a=t.field08_crc()).length().toString()),display("output_can_data11_field08",a.toBinStringWithSpacesRightAlign()),display("output_can_data11_field08_hex",a.toHexString()),display("output_can_data11_field09_len",(a=t.field09_crcDelimiter()).length().toString()),display("output_can_data11_field09",a.toBinString()),display("output_can_data11_field09_hex",a.toHexString()),display("output_can_data11_field10_len",(a=t.field10_ackSlot()).length().toString()),display("output_can_data11_field10",a.toBinString()),display("output_can_data11_field10_hex",a.toHexString()),display("output_can_data11_field11_len",(a=t.field11_ackDelimiter()).length().toString()),display("output_can_data11_field11",a.toBinString()),display("output_can_data11_field11_hex",a.toHexString()),display("output_can_data11_field12_len",(a=t.field12_endOfFrame()).length().toString()),display("output_can_data11_field12",a.toBinStringWithSpacesRightAlign()),display("output_can_data11_field12_hex",a.toHexString()),display("output_can_data11_field13_len",(a=t.field13_interFrameSpace()).length().toString()),display("output_can_data11_field13",a.toBinString()),display("output_can_data11_field13_hex",a.toHexString()),unhide("output_table_title"),unhide("output_table_data11bit")}function displayCanFrame29BitFields(t){let a;display("output_can_data29_field01_len",(a=t.field01_startOfFrame()).length().toString()),display("output_can_data29_field01",a.toBinString()),display("output_can_data29_field01_hex",a.toHexString()),display("output_can_data29_field02_len",(a=t.field02_identifierPartA()).length().toString()),display("output_can_data29_field02",a.toBinStringWithSpacesRightAlign()),display("output_can_data29_field02_hex",a.toHexString()),display("output_can_data29_field03_len",(a=t.field03_substituteRemoteRequest()).length().toString()),display("output_can_data29_field03",a.toBinString()),display("output_can_data29_field03_hex",a.toHexString()),display("output_can_data29_field04_len",(a=t.field04_identifierExtensionBit()).length().toString()),display("output_can_data29_field04",a.toBinString()),display("output_can_data29_field04_hex",a.toHexString()),display("output_can_data29_field05_len",(a=t.field05_identifierPartB()).length().toString()),display("output_can_data29_field05",a.toBinStringWithSpacesRightAlign()),display("output_can_data29_field05_hex",a.toHexString()),display("output_can_data29_field06_len",(a=t.field06_remoteTransmissionRequest()).length().toString()),display("output_can_data29_field06",a.toBinString()),display("output_can_data29_field06_hex",a.toHexString()),display("output_can_data29_field07_len",(a=t.field07_reservedBit1()).length().toString()),display("output_can_data29_field07",a.toBinString()),display("output_can_data29_field07_hex",a.toHexString()),display("output_can_data29_field08_len",(a=t.field08_reservedBit0()).length().toString()),display("output_can_data29_field08",a.toBinString()),display("output_can_data29_field08_hex",a.toHexString()),display("output_can_data29_field09_len",(a=t.field09_dataLengthCode()).length().toString()),display("output_can_data29_field09",a.toBinString()),display("output_can_data29_field09_hex",a.toHexString()),display("output_can_data29_field10_len",(a=t.field10_dataField()).length().toString()),display("output_can_data29_field10",a.toBinStringWithSpacesRightAlign()),display("output_can_data29_field10_hex",a.toHexString()),display("output_can_data29_field11_len",(a=t.field11_crc()).length().toString()),display("output_can_data29_field11",a.toBinStringWithSpacesRightAlign()),display("output_can_data29_field11_hex",a.toHexString()),display("output_can_data29_field12_len",(a=t.field12_crcDelimiter()).length().toString()),display("output_can_data29_field12",a.toBinString()),display("output_can_data29_field12_hex",a.toHexString()),display("output_can_data29_field13_len",(a=t.field13_ackSlot()).length().toString()),display("output_can_data29_field13",a.toBinString()),display("output_can_data29_field13_hex",a.toHexString()),display("output_can_data29_field14_len",(a=t.field14_ackDelimiter()).length().toString()),display("output_can_data29_field14",a.toBinString()),display("output_can_data29_field14_hex",a.toHexString()),display("output_can_data29_field15_len",(a=t.field15_endOfFrame()).length().toString()),display("output_can_data29_field15",a.toBinStringWithSpacesRightAlign()),display("output_can_data29_field15_hex",a.toHexString()),display("output_can_data29_field16_len",(a=t.field16_interFrameSpace()).length().toString()),display("output_can_data29_field16",a.toBinString()),display("output_can_data29_field16_hex",a.toHexString()),unhide("output_table_title"),unhide("output_table_data29bit")}function parseCanFrameBitrateFromInputForm(){const t=read("input_can_bitrate").trim().toLowerCase();if(0===t.length)throw new ValidationError("Empty bitrate",Field.BITRATE);if(t.startsWith("0x")||t.startsWith("0b")||t.startsWith("0o"))throw new ValidationError("Bitrate can be expressed only in base 10. Found: "+t,Field.BITRATE);const a=Number(t);if(isNaN(a))throw new ValidationError("Incorrect bitrate format. Cannot be parsed. Found: "+t,Field.BITRATE);return a}function parseCanFrameTypeFromInputForm(){const t=read("input_frame_type");switch(t){case"can_data11":case"can_data29":case"can_rtr11":case"can_rtr29":return t;case"canfd_data11":case"canfd_data29":default:throw new ValidationError("Unsupported frame type "+t,Field.TYPE)}}function parseCanDlcFromInputForm(){const t=read("input_can_dlc").trim();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;default:throw new ValidationError("Unsupported DLC value "+t,Field.DLC)}}function parseCanIdentifierFromInputForm(){let t=read("input_can_identifier");if(0===(t=t.trim().toLowerCase()).length)throw new ValidationError("Insert an identifier value.",Field.ID);const a=read("input_can_identifier_base");switch(a){case"0b":if(t.startsWith("0b"))t=t.substring(2);else if(t.startsWith("0x"))throw new ValidationError("'0x' prefix not supported for binary input.",Field.ID);break;case"":if(t.startsWith("0b")||t.startsWith("0x"))throw new ValidationError("'0b' or '0x' prefixes not supported for decimal input.",Field.ID);break;case"0x":t.startsWith("0x")&&(t=t.substring(2));break;default:throw new ValidationError("Unsupported base prefix "+a,Field.ID)}const e=Number(a+t);if(isNaN(e))throw new ValidationError("Invalid identifier number format.",Field.ID);return e}function parseCanPayloadFromInputForm(){let t=read("input_can_payload");if(0===(t=t.toLowerCase().replaceAll(/0x|[\s,]/g,"")).length)return new Uint8Array(0);const a=t.match(/[^0-9a-f]/g);if(null!==a)throw new ValidationError("Illegal characters found: "+a+".",Field.PAYLOAD);if(t.length%2!=0)throw new ValidationError("Odd amount of hex characters.",Field.PAYLOAD);const e=t.match(/../g).map(t=>parseInt(t,16));if(e.includes(NaN))throw new ValidationError("Failed parsing of hex characters.",Field.PAYLOAD);return new Uint8Array(e)}function displayInputFormForDataFrame(){hide("input_can_dlc_block"),unhide("input_can_payload_block")}function displayInputFormForRtrFrame(){hide("input_can_payload_block"),unhide("input_can_dlc_block")}function resetInputForm(){document.getElementById("input_frame_type").selectedIndex=0,document.getElementById("input_can_identifier").value="",document.getElementById("input_can_identifier_base").selectedIndex=1,document.getElementById("input_can_payload").value="",document.getElementById("input_can_dlc").selectedIndex=0,document.getElementById("input_can_bitrate").selectedIndex=6}function alterInputFormOnFrameTypeChange(t){switch(clearErrorsAndOutputs(),t.value){case"can_data11":case"can_data29":case"canfd_data11":case"canfd_data29":displayInputFormForDataFrame();break;case"can_rtr11":case"can_rtr29":displayInputFormForRtrFrame();break;default:displayUnknownError(new ValidationError("Unsupported frame type "+t.value,Field.TYPE))}}function calculate(){try{clearErrorsAndOutputs();const t=parseCanFrameTypeFromInputForm(),a=parseCanIdentifierFromInputForm(),e=parseCanFrameBitrateFromInputForm();let i,_=null,n=null;switch(t){case"can_data11":_=parseCanPayloadFromInputForm(),displayCanFrame11BitFields(i=new CanFrame11Bit(a,_,n));break;case"can_data29":_=parseCanPayloadFromInputForm(),displayCanFrame29BitFields(i=new CanFrame29Bit(a,_,n));break;case"can_rtr11":n=parseCanDlcFromInputForm(),displayCanFrame11BitFields(i=new CanFrame11Bit(a,_,n));break;case"can_rtr29":n=parseCanDlcFromInputForm(),displayCanFrame29BitFields(i=new CanFrame29Bit(a,_,n));break;default:displayUnknownError(new ValidationError("Unsupported frame type: "+t,Field.DLC))}displayCanFrameWholeFrame(i,e)}catch(t){displayError(t)}}function displayError(t){if(t instanceof ValidationError)switch(t.field){case Field.ID:highlightIncorrectInput("input_can_identifier"),displayInputFormError(t.message);break;case Field.PAYLOAD:highlightIncorrectInput("input_can_payload"),displayInputFormError(t.message);break;case Field.DLC:highlightIncorrectInput("input_can_dlc"),displayInputFormError(t.message);break;case Field.TYPE:highlightIncorrectInput("input_frame_type"),displayInputFormError(t.message);break;default:displayUnknownError(t)}else displayUnknownError(t)}function onKeyPress(t){"Enter"===t.key&&calculate()}document.onkeydown=onKeyPress,resetInputForm();</script>
<script>let bits,frame,toComputeCrcOn,expectedWholeFrame,expectedWholeFrameStuffed,crcBits,check=console.assert;function arrayEqual(e,c){let t=Array.isArray(e)&&Array.isArray(c)&&e.length===c.length,n=e instanceof Uint8Array&&c instanceof Uint8Array&&e.length===c.length;if(t||n){for(let t=0;t<e.length;t++)if(e[t]!==c[t])return!1;return!0}return!1}console.log("Starting unit tests."),check(0===BitSequence.maxAmountOfStuffBits(0)),check(0===BitSequence.maxAmountOfStuffBits(1)),check(0===BitSequence.maxAmountOfStuffBits(2)),check(0===BitSequence.maxAmountOfStuffBits(3)),check(0===BitSequence.maxAmountOfStuffBits(4)),check(1===BitSequence.maxAmountOfStuffBits(5)),check(1===BitSequence.maxAmountOfStuffBits(6)),check(1===BitSequence.maxAmountOfStuffBits(7)),check(1===BitSequence.maxAmountOfStuffBits(8)),check(2===BitSequence.maxAmountOfStuffBits(9)),check(2===BitSequence.maxAmountOfStuffBits(10)),check(2===BitSequence.maxAmountOfStuffBits(11)),check(2===BitSequence.maxAmountOfStuffBits(12)),check(3===BitSequence.maxAmountOfStuffBits(13)),check(3===BitSequence.maxAmountOfStuffBits(14)),check(3===BitSequence.maxAmountOfStuffBits(15)),check(3===BitSequence.maxAmountOfStuffBits(16)),check(4===BitSequence.maxAmountOfStuffBits(17)),check(4===BitSequence.maxAmountOfStuffBits(18)),check(4===BitSequence.maxAmountOfStuffBits(19)),check(4===BitSequence.maxAmountOfStuffBits(20)),check(5===BitSequence.maxAmountOfStuffBits(21)),check(0===BitSequence.maxLengthAfterStuffing(0)),check(1===BitSequence.maxLengthAfterStuffing(1)),check(2===BitSequence.maxLengthAfterStuffing(2)),check(3===BitSequence.maxLengthAfterStuffing(3)),check(4===BitSequence.maxLengthAfterStuffing(4)),check(6===BitSequence.maxLengthAfterStuffing(5)),check(7===BitSequence.maxLengthAfterStuffing(6)),check(8===BitSequence.maxLengthAfterStuffing(7)),check(9===BitSequence.maxLengthAfterStuffing(8)),check(11===BitSequence.maxLengthAfterStuffing(9)),check(12===BitSequence.maxLengthAfterStuffing(10)),check(13===BitSequence.maxLengthAfterStuffing(11)),check(14===BitSequence.maxLengthAfterStuffing(12)),check(16===BitSequence.maxLengthAfterStuffing(13)),check(17===BitSequence.maxLengthAfterStuffing(14)),check(18===BitSequence.maxLengthAfterStuffing(15)),check(19===BitSequence.maxLengthAfterStuffing(16)),check(21===BitSequence.maxLengthAfterStuffing(17)),check(22===BitSequence.maxLengthAfterStuffing(18)),check(23===BitSequence.maxLengthAfterStuffing(19)),check(24===BitSequence.maxLengthAfterStuffing(20)),check(26===BitSequence.maxLengthAfterStuffing(21)),check(arrayEqual((bits=new BitSequence)._sequence,[]),bits._sequence),check(!1===bits._isStuffed),check(arrayEqual((bits=new BitSequence("    1 "))._sequence,[1])),check(!1===bits._isStuffed),check(arrayEqual((bits=new BitSequence("      0  1    "))._sequence,[0,1])),check(!1===bits._isStuffed),check(arrayEqual((bits=new BitSequence("      0  1  101    "))._sequence,[0,1,1,0,1])),check(!1===bits._isStuffed),check(arrayEqual((bits=new BitSequence("      0  1  101    ",!0))._sequence,[0,1,1,0,1])),check(!0===bits._isStuffed),check(arrayEqual((bits=new BitSequence([0,1,0]))._sequence,[0,1,0])),check(!1===bits._isStuffed),check(arrayEqual((bits=new BitSequence([!1,!0,!1]))._sequence,[0,1,0])),check(!1===bits._isStuffed),check(arrayEqual((bits=new BitSequence([1,!1,"0"]))._sequence,[1,0,0])),check(!1===bits._isStuffed),check(arrayEqual((bits=new BitSequence(0))._sequence,[0])),check(!1===bits._isStuffed),check(arrayEqual((bits=new BitSequence(1))._sequence,[1])),check(!1===bits._isStuffed),check(arrayEqual((bits=new BitSequence(!1))._sequence,[0])),check(!1===bits._isStuffed),check(arrayEqual((bits=new BitSequence(!0))._sequence,[1])),check(!1===bits._isStuffed),check((new BitSequence).applyBitStuffing().equal(new BitSequence("",!0))),check(new BitSequence("1").applyBitStuffing().equal(new BitSequence("1",!0))),check(new BitSequence("1110101010").applyBitStuffing().equal(new BitSequence("1110101010",!0))),check(new BitSequence("11111").applyBitStuffing().equal(new BitSequence("111112",!0))),check(new BitSequence("111110000").applyBitStuffing().equal(new BitSequence("11111200003",!0)));try{new BitSequence("111110",!0).applyBitStuffing(),check(!1,"Error nor raised")}catch(e){}check(0===(new BitSequence).length()),check(1===new BitSequence("1").length()),check(10===new BitSequence("1110101010").length()),check(5===new BitSequence("11111").length()),check(11===new BitSequence("11111000001",!0).length()),check(""===new BitSequence("").toBinString()),check("0"===new BitSequence("0").toBinString()),check("10"===new BitSequence("10").toBinString()),check("0010"===new BitSequence("0010").toBinString()),check("0110101"===new BitSequence("0110101").toBinString()),check("0110101"===new BitSequence("0110101").toBinString("[","]")),check("11111[0]1"===new BitSequence("1111121",!0).toBinString("[","]")),check("00000[1]1"===new BitSequence("0000031",!0).toBinString("[","]")),check(""===new BitSequence("").toBinStringWithSpacesRightAlign()),check("0"===new BitSequence("0").toBinStringWithSpacesRightAlign()),check("10"===new BitSequence("10").toBinStringWithSpacesRightAlign()),check("0010"===new BitSequence("0010").toBinStringWithSpacesRightAlign()),check("011 0101"===new BitSequence("0110101").toBinStringWithSpacesRightAlign()),check("0 1011 0101"===new BitSequence("010110101").toBinStringWithSpacesRightAlign()),check("0 1011 0101"===new BitSequence("010110101").toBinStringWithSpacesRightAlign("[","]")),check("00 0111 11[0]1"===new BitSequence("0001111121",!0).toBinStringWithSpacesRightAlign("[","]")),check("000 00[1]1"===new BitSequence("0000031",!0).toBinStringWithSpacesRightAlign("[","]")),check(""===new BitSequence("").toBinStringWithSpacesLeftAlign()),check("0"===new BitSequence("0").toBinStringWithSpacesLeftAlign()),check("10"===new BitSequence("10").toBinStringWithSpacesLeftAlign()),check("0010"===new BitSequence("0010").toBinStringWithSpacesLeftAlign()),check("0110 101"===new BitSequence("0110101").toBinStringWithSpacesLeftAlign()),check("0101 1010 1"===new BitSequence("010110101").toBinStringWithSpacesLeftAlign()),check("0101 1010 1"===new BitSequence("010110101").toBinStringWithSpacesLeftAlign("[","]")),check("0001 1111 [0]1"===new BitSequence("0001111121",!0).toBinStringWithSpacesLeftAlign("[","]")),check("0000 0[1]1"===new BitSequence("0000031",!0).toBinStringWithSpacesLeftAlign("[","]")),check(""===new BitSequence("").toHexString()),check("0"===new BitSequence("0").toHexString()),check("000"===new BitSequence("00 0000 0000").toHexString()),check("2"===new BitSequence("10").toHexString()),check("2"===new BitSequence("0010").toHexString()),check("35"===new BitSequence("0110101").toHexString()),check("01F"===new BitSequence("0 0001 1111").toHexString()),check("11F"===new BitSequence("1 0001 1111").toHexString()),check("2FF"===new BitSequence("10 1111 1111").toHexString()),check(""===new BitSequence("").extend("").toBinString()),check("0"===new BitSequence("").extend("0").toBinString()),check("1"===new BitSequence("").extend("1").toBinString()),check("01"===new BitSequence("").extend("01").toBinString()),check("100"===new BitSequence("1").extend("00").toBinString()),check("011"===new BitSequence("0").extend("11").toBinString()),check("0100"===new BitSequence("01").extend("00").toBinString()),check("010"===new BitSequence("01").extend(0).toBinString()),check("011"===new BitSequence("01").extend(1).toBinString()),check("010"===new BitSequence("01").extend(!1).toBinString()),check("011"===new BitSequence("01").extend(!0).toBinString()),bits=new BitSequence("");for(let e of bits)check(!1,"This should not be executed.");bits=new BitSequence("1");for(let e of bits)check(1===e);bits=new BitSequence("101");for(let e of bits)check(1===e||0===e);check(0===crc15([0])),check(25334===crc15([1,1,1,1,0,0,0,1])),check(25334===crc15([!0,!0,!0,!0,0,0,!1,1])),check(1140===crc15([1,0,0,0,0,0,1,1,0,0,1,1])),check(8874===crc15([1,1,0,1,0,0,1,1,1,0,1,1,0,0])),check(0===crc17([0])),check(572===crc17([1,1,1,1,0,0,0,1])),check(17895===crc17([1,0,0,0,0,0,1,1,0,0,1,1])),check(3757===crc17([1,1,0,1,0,0,1,1,1,0,1,1,0,0])),check(0===crc21([0])),check(96057===crc21([1,1,1,1,0,0,0,1])),check(1273517===crc21([1,0,0,0,0,0,1,1,0,0,1,1])),check(308572===crc21([1,1,0,1,0,0,1,1,1,0,1,1,0,0])),check(0===(frame=new CanFrame11Bit(0,new Uint8Array(0))).id),check(arrayEqual(frame.payload,new Uint8Array(0))),check(frame.field01_startOfFrame().equal(new BitSequence(0))),check(frame.field02_identifier().equal(new BitSequence("000 0000 0000"))),check(frame.field03_remoteTransmissionRequest().equal(new BitSequence(0))),check(frame.field04_identifierExtensionBit().equal(new BitSequence(0))),check(frame.field05_reservedBit().equal(new BitSequence(0))),check(frame.field06_dataLengthCode().equal(new BitSequence("0000"))),check(frame.field07_dataField().equal(new BitSequence)),toComputeCrcOn=new BitSequence("0  000 0000 0000  0  0  0000"),check(frame.field08_crc().equal(new BitSequence("000 0000 0000 0000"))),check(frame.field09_crcDelimiter().equal(new BitSequence(1))),check(frame.field10_ackSlot().equal(new BitSequence(1))),check(frame.field11_ackDelimiter().equal(new BitSequence(1))),check(frame.field12_endOfFrame().equal(new BitSequence("111 1111"))),check(frame.field13_interFrameSpace().equal(new BitSequence("111"))),expectedWholeFrame=new BitSequence("0  000 0000 0000  0  0  0  0000  000 0000 0000 0000  1  1  1  111 1111  111"),check(frame.wholeFrame().equal(expectedWholeFrame)),expectedWholeFrameStuffed=new BitSequence("0  000 03000 00300  0  0  03  0000  0300 00030 0000 30000  1  1  1  111 1111  111",!0),check(frame.wholeFrameStuffed().equal(expectedWholeFrameStuffed)),check(0===(frame=new CanFrame11Bit(0,new Uint8Array(1))).id),check(arrayEqual(frame.payload,new Uint8Array(1))),check(frame.field01_startOfFrame().equal(new BitSequence(0))),check(frame.field02_identifier().equal(new BitSequence("000 0000 0000"))),check(frame.field03_remoteTransmissionRequest().equal(new BitSequence(0))),check(frame.field04_identifierExtensionBit().equal(new BitSequence(0))),check(frame.field05_reservedBit().equal(new BitSequence(0))),check(frame.field06_dataLengthCode().equal(new BitSequence("0001"))),check(frame.field07_dataField().equal(new BitSequence("0000 0000"))),toComputeCrcOn=new BitSequence("0  000 0000 0000  0  0  0001  0000 0000"),crcBits=new BitSequence(crc15(toComputeCrcOn).toString(2).padStart(15,"0")),check(frame.field08_crc().equal(crcBits)),check(frame.field09_crcDelimiter().equal(new BitSequence(1))),check(frame.field10_ackSlot().equal(new BitSequence(1))),check(frame.field11_ackDelimiter().equal(new BitSequence(1))),check(frame.field12_endOfFrame().equal(new BitSequence("111 1111"))),check(frame.field13_interFrameSpace().equal(new BitSequence("111"))),expectedWholeFrame=new BitSequence("0  000 0000 0000  0  0  0  0001  0000 0000100 0100 0010 01101  1  1  111 1111  111"),check(frame.wholeFrame().equal(expectedWholeFrame)),expectedWholeFrameStuffed=new BitSequence("0  000 03000 00300  0  0  03  0001  0000 03000100 0100 0010 01101  1  1  111 1111  111",!0),check(frame.wholeFrameStuffed().equal(expectedWholeFrameStuffed)),(frame=new CanFrame11Bit(307,new Uint8Array(8))).payload[0]=255,frame.payload[7]=255,check(307===frame.id),check(255===frame.payload[0]),check(0===frame.payload[1]),check(0===frame.payload[6]),check(255===frame.payload[7]),check(frame.field01_startOfFrame().equal(new BitSequence(0))),check(frame.field02_identifier().equal(new BitSequence("001 0011 0011"))),check(frame.field03_remoteTransmissionRequest().equal(new BitSequence(0))),check(frame.field04_identifierExtensionBit().equal(new BitSequence(0))),check(frame.field05_reservedBit().equal(new BitSequence(0))),check(frame.field06_dataLengthCode().equal(new BitSequence("1000"))),check(frame.field07_dataField().equal(new BitSequence("1111 1111  0000 0000  0000 0000  0000 00000000 0000  0000 0000  0000 0000  1111 1111"))),toComputeCrcOn=new BitSequence("0  001 0011 0011  0  0  0  1000  1111 1111  0000 0000  0000 0000  0000 00000000 0000  0000 0000  0000 0000  1111 1111"),crcBits=new BitSequence(crc15(toComputeCrcOn).toString(2).padStart(15,"0")),check(frame.field08_crc().equal(crcBits)),check(frame.field09_crcDelimiter().equal(new BitSequence(1))),check(frame.field10_ackSlot().equal(new BitSequence(1))),check(frame.field11_ackDelimiter().equal(new BitSequence(1))),check(frame.field12_endOfFrame().equal(new BitSequence("111 1111"))),check(frame.field13_interFrameSpace().equal(new BitSequence("111"))),expectedWholeFrame=new BitSequence("0  001 0011 0011  0  0  0  1000  1111 1111  0000 0000  0000 0000  0000 00000000 0000  0000 0000  0000 0000  1111 1111001 1000 0101 11111  1  1  111 1111  111"),check(frame.wholeFrame().equal(expectedWholeFrame)),expectedWholeFrameStuffed=new BitSequence("0  001 0011 0011  0  0  0  1000  1111 12111  0000 03000  00300 00030  00003 000003000 00300  00030 00003  0000 03000  1111 12111001 1000 0101 111121  1  1  111 1111  111",!0),check(frame.wholeFrameStuffed().equal(expectedWholeFrameStuffed));const headerLength=19,crcLength=15,postCrcLength=13;for(let e=0;e<=8;e++){let c=new Uint8Array(e);frame=new CanFrame11Bit(0,c);let t=BitSequence.maxLengthAfterStuffing(19+8*c.length+15)+13;check(frame.maxLengthAfterStuffing()===t,c)}</script>
</body>
</html>
